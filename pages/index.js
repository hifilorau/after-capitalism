import React, {useState, useEffect} from 'react'
import Head from 'next/head'
import Image from 'next/image'
import styles from '../styles/Home.module.scss'
import HeaderContent from '../components/HeaderContent'
import ExcerptBlock from '../components/ExcerptBlock'
import SignUp from '../components/Signup'
import Testimonials from '../components/Testimonials'
import Monitoring from '../components/Monitoring'
import Link from 'next/link'

const books = [{
  storeName: 'Amazon',
  link: 'www.amazon.com/andy'
},
{
  storeName: 'Apple',
  link: 'www.amazon.com/andy'
},
{
  storeName: 'Barnes & Noble',
  link: 'www.amazon.com/andy'
},
{
  storeName: 'Books A Million',
  link: 'www.amazon.com/andy'
}]

export default function Home() {

  const [posts, setPosts] = useState([]);
  useEffect(() => {
      async function loadPosts() {
          const response = await fetch('https://api.imaginingaftercapitalism.com/wp-json/wp/v2/posts');
          if(!response.ok) {
              // oups! something went wrong
              return;
          }
  
          const posts = await response.json();
          setPosts(posts);
      }
  
      loadPosts();
 }, [])

   console.log('POSTS', posts)
  return (
    <>
    <Head>
    <title>Create Next App</title>
    <meta name="description" content="Generated by create next app" />
    <link rel="icon" href="/favicon.ico" />
  </Head>
    <div>
      <div className={styles.header}>
        <div className={styles.banner}>
          <Image src="/ben.png" layout="responsive" width={1440} height={580}/>
        </div>
        <HeaderContent/>
      </div>
      
      <div className={styles.bookLinks}>
        <div className={styles.squigglyWrapper}>
          <Image src="/squigglys.png" width={1800} height={270} layout="fill"/>
        </div>
        <h2>Available For Order or Download</h2>
        <ul className={styles.booksUl}>
          {books && books.map((book) => {
            return (
              <li key={book.storeName}>
                <Link href={book.link}>
                  <a className={styles.buttonLink}>
                    {book.storeName}
                  </a>
                </Link>
              </li>
            )})
          }
        </ul>
      </div>
      <div className={styles.excerptAndSignup}>
          <ExcerptBlock />
          <SignUp />
      </div>

 
      <Testimonials />
     
      {posts && <Monitoring posts={posts}/> }
      

      <footer className={`${styles.footer}`}>
      <div className={styles.squigglyWrapper}>
          <Image src="/squigglys.png" width={1800} height={270} layout="fill"/>
      </div>
       
      <a href="https://vercel.com?utm_source=create-next-app&utm_medium=default-template&utm_campaign=create-next-app"
          target="_blank"
          rel="noopener noreferrer"
        > Resources
        </a>
        <a
          href="https://vercel.com?utm_source=create-next-app&utm_medium=default-template&utm_campaign=create-next-app"
          target="_blank"
          rel="noopener noreferrer"
        >FAQs
        </a>
        <a
          href="https://vercel.com?utm_source=create-next-app&utm_medium=default-template&utm_campaign=create-next-app"
          target="_blank"
          rel="noopener noreferrer"
        >Media Links
        </a>
      </footer>
    </div>
    </>
  )
}
